"use strict";(self.webpackChunkleo_travels_app=self.webpackChunkleo_travels_app||[]).push([[958],{9958:(q,c,i)=>{i.r(c),i.d(c,{CouponsModule:()=>$});var d=i(6895),m=i(7337),f=i(4684),t=i(4650),s=i(4006),x=i(4128),h=i(5412),g=i(3615),C=i(8142),T=i(1740),Z=i(7188),M=i(8645),D=i(5722);let y=(()=>{class e extends f.K{constructor(){super(...arguments),this.data=(0,t.f3M)(h.WI),this.dialogRef=(0,t.f3M)(h.so),this.loading=!1,this.minDate=new Date,this.products=[],this.form=this.fb.group({coupon:["",s.kI.required],descriptionName:["",s.kI.required],discount:[0,s.kI.required],startDate:[this.minDate,s.kI.required],endDate:["",s.kI.required],products:[null,s.kI.required]})}ngOnInit(){this.data&&(this.form.patchValue(this.data),this.form.get("endDate")?.setValue(new Date(this.data.endDate)),this.form.get("startDate")?.setValue(new Date(this.data.startDate))),this.getValues()}ngOnDestroy(){this.$getValues.unsubscribe()}getValues(){this.$getValues=(0,x.D)({products:this.baseService.getMethod("product"),course:this.baseService.getMethod("course/all-courses")}).subscribe({next:({products:o,course:a})=>{const u=structuredClone(o),l=structuredClone(a);this.products=[...u.data,...l.data]}})}validateAction(){if(!this.form.invalid){if(this.loading=!0,!this.data)return void this.save();this.update()}}update(){const o=this.form.getRawValue();this.baseService.patchMethod("discount-coupons/"+this.data._id,o).subscribe({next:()=>{this.messageService.succesMessage("succes.succesUpdate"),this.form.reset(),this.loading=!1,this.dialogRef.close({refresh:!0})},error:()=>this.loading=!1})}save(){const o=this.form.getRawValue();this.baseService.postMethod("discount-coupons",o).subscribe({next:()=>{this.messageService.succesMessage("succes.succesCreate"),this.form.reset(),this.loading=!1,this.dialogRef.close({refresh:!0})},error:()=>this.loading=!1})}upperCaseFormat(){if(this.form.get("coupon")?.value.trim()){const o=this.form.get("coupon")?.value.toUpperCase().trim();this.form.get("coupon")?.setValue(o)}}}return e.\u0275fac=function(){let n;return function(a){return(n||(n=t.n5z(e)))(a||e)}}(),e.\u0275cmp=t.Xpm({type:e,selectors:[["app-form-coupon"]],features:[t.qOj],decls:23,vars:17,consts:[[3,"titleModal"],[3,"formGroup"],[1,"content-form"],[1,"grid-two-columns"],[1,"p-float-label"],["pInputText","","id","username","formControlName","coupon",1,"input-name",3,"keyup"],["htmlFor","username"],["pInputText","","id","username","formControlName","descriptionName",1,"input-name"],["formControlName","products","defaultLabel","Seleccionar","optionValue","_id","optionLabel","name","display","chip",3,"options"],["id","float-input","formControlName","discount"],["for","float-input"],[1,"card","flex","justify-content-center"],["formControlName","startDate",3,"readonlyInput","minDate","showIcon","showTime","showSeconds","appendTo"],["formControlName","endDate",3,"readonlyInput","minDate","showIcon","showTime","showSeconds","appendTo"],[3,"disabledButton","loading","handleSaveButton"]],template:function(o,a){if(1&o&&(t._UZ(0,"app-title-modal",0),t.TgZ(1,"form",1)(2,"div",2)(3,"div",3)(4,"span",4)(5,"input",5),t.NdJ("keyup",function(){return a.upperCaseFormat()}),t.qZA(),t.TgZ(6,"label",6),t._uU(7,"Cupon"),t.qZA()(),t.TgZ(8,"span",4),t._UZ(9,"input",7),t.TgZ(10,"label",6),t._uU(11,"Descripci\xf3n"),t.qZA()()(),t.TgZ(12,"div",3),t._UZ(13,"p-multiSelect",8),t.TgZ(14,"span",4),t._UZ(15,"p-inputNumber",9),t.TgZ(16,"label",10),t._uU(17," Descuento "),t.qZA()()(),t.TgZ(18,"div",3)(19,"div",11),t._UZ(20,"p-calendar",12),t.qZA(),t._UZ(21,"p-calendar",13),t.qZA()()(),t.TgZ(22,"app-buttons-modal",14),t.NdJ("handleSaveButton",function(){return a.validateAction()}),t.qZA()),2&o){let u;t.Q6J("titleModal",a.data?"Actualizar cupon":"Crear cupon"),t.xp6(1),t.Q6J("formGroup",a.form),t.xp6(12),t.Q6J("options",a.products),t.xp6(7),t.Q6J("readonlyInput",!0)("minDate",a.minDate)("showIcon",!0)("showTime",!0)("showSeconds",!0)("appendTo","body"),t.xp6(1),t.Q6J("readonlyInput",!0)("minDate",null==(u=a.form.get("startDate"))?null:u.value)("showIcon",!0)("showTime",!0)("showSeconds",!0)("appendTo","body"),t.xp6(1),t.Q6J("disabledButton",a.form.invalid)("loading",a.loading)}},dependencies:[g.p,s._Y,s.Fj,s.JJ,s.JL,s.sg,s.u,C.i,T.o,Z.Rn,M.f,D.NU],styles:[".custom-file-input[_ngcontent-%COMP%]{display:none}.custom-file-label[_ngcontent-%COMP%]{display:inline-block;padding:10px 20px;background-color:#222e5e;color:#fff;border-radius:5px;cursor:pointer}  .p-button{background:#222e5e}form[_ngcontent-%COMP%]{width:90%;margin:30px auto}.content-form[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr;grid-row-gap:30px}  p-inputNumber,   .p-inputnumber,   .p-multiselect,   .p-calendar, .input-name[_ngcontent-%COMP%]{width:100%}.content-three[_ngcontent-%COMP%]{width:335px;display:grid;grid-template-columns:repeat(3,1fr);gap:20px}.content-images[_ngcontent-%COMP%]{display:flex;width:100%;justify-content:space-between;max-height:45px}.content-images[_ngcontent-%COMP%]   .p-fluid[_ngcontent-%COMP%]{width:75%}  .p-fluid .p-chips{max-height:45px}  .cdk-overlay-pane{min-width:70%}.grid-two-columns[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;column-gap:25px}  .p-calendar .p-datepicker{z-index:10000000000;position:initial;max-height:300px;overflow:auto}  .p-overlay-content{position:fixed}@media screen and (max-width: 500px){form[_ngcontent-%COMP%]{overflow:auto;height:65vh}.grid-two-columns[_ngcontent-%COMP%]{grid-template-columns:1fr;row-gap:30px;max-width:max-content}}"]}),e})();var r=i(671),_=i(7392),b=i(266),v=i(9524);function w(e,n){1&e&&(t.TgZ(0,"th",14),t._uU(1," Cupon "),t.qZA())}function A(e,n){if(1&e&&(t.TgZ(0,"td",15),t._uU(1),t.qZA()),2&e){const o=n.$implicit;t.Q6J("matTooltipPosition","left")("matTooltip",o.coupon),t.xp6(1),t.hij(" ",o.coupon," ")}}function N(e,n){1&e&&(t.TgZ(0,"th",14),t._uU(1," Descuento "),t.qZA())}function U(e,n){if(1&e&&(t.TgZ(0,"td",16),t._uU(1),t.qZA()),2&e){const o=n.$implicit;t.xp6(1),t.hij(" ",o.discount," ")}}function S(e,n){1&e&&(t.TgZ(0,"th",14),t._uU(1," Fecha inicio "),t.qZA())}function O(e,n){if(1&e&&(t.TgZ(0,"td",16),t._uU(1),t.ALo(2,"date"),t.qZA()),2&e){const o=n.$implicit;t.xp6(1),t.hij(" ",t.xi3(2,1,o.startDate,"MM/dd/Y H:m:ss")," ")}}function J(e,n){1&e&&(t.TgZ(0,"th",14),t._uU(1," Fecha fin "),t.qZA())}function F(e,n){if(1&e&&(t.TgZ(0,"td",16),t._uU(1),t.ALo(2,"date"),t.qZA()),2&e){const o=n.$implicit;t.xp6(1),t.hij(" ",t.xi3(2,1,o.endDate,"MM/dd/Y H:m:ss")," ")}}function B(e,n){1&e&&(t.TgZ(0,"th",14),t._uU(1," Acciones "),t.qZA())}function P(e,n){if(1&e){const o=t.EpF();t.TgZ(0,"td",16)(1,"mat-icon",17),t.NdJ("click",function(){const l=t.CHM(o).$implicit,p=t.oxw();return t.KtG(p.openModal(l))}),t._uU(2,"edit"),t.qZA(),t.TgZ(3,"mat-icon",17),t.NdJ("click",function(){const l=t.CHM(o).$implicit,p=t.oxw();return t.KtG(p.confirmRemove(l))}),t._uU(4," delete "),t.qZA()()}}function I(e,n){1&e&&t._UZ(0,"tr",18)}function R(e,n){1&e&&t._UZ(0,"tr",19)}const Q=[{path:"",component:(()=>{class e extends f.K{constructor(){super(...arguments),this.createModal=y,this.displayedColumns=["coupon","discount","startDate","endDate","actions"],this.dataSource=[]}ngOnInit(){this.getAll()}ngOnDestroy(){this.$dialog&&this.$dialog.unsubscribe()}getAll(){this.baseService.getMethod("discount-coupons").subscribe({next:o=>{this.dataSource=o.data}})}openModal(o){this.$dialog=this.dialog.open(this.createModal,{hasBackdrop:!0,data:o,height:"auto"}).afterClosed().subscribe({next:({refresh:a})=>{a&&this.getAll()}})}confirmRemove(o){this.messageService.confirmRevomeMessage("info.confirmRemove").then(a=>{a.isConfirmed&&this.remove(o)})}remove(o){this.baseService.deleteMethod("discount-coupons/"+o._id).subscribe({next:()=>{this.messageService.succesMessage("succes.succesRemove"),this.getAll()}})}}return e.\u0275fac=function(){let n;return function(a){return(n||(n=t.n5z(e)))(a||e)}}(),e.\u0275cmp=t.Xpm({type:e,selectors:[["app-coupon"]],features:[t.qOj],decls:21,vars:6,consts:[[3,"title","removeButton","description","handleClick"],[1,"content-component"],[1,"table-transactions"],["mat-table","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","coupon"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",3,"matTooltipPosition","matTooltip",4,"matCellDef"],["matColumnDef","discount"],["mat-cell","",4,"matCellDef"],["matColumnDef","startDate"],["matColumnDef","endDate"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell","",3,"matTooltipPosition","matTooltip"],["mat-cell",""],[3,"click"],["mat-header-row",""],["mat-row",""]],template:function(o,a){1&o&&(t.TgZ(0,"app-header-modules",0),t.NdJ("handleClick",function(){return a.openModal()}),t.qZA(),t.TgZ(1,"div",1)(2,"div",2)(3,"table",3),t.ynx(4,4),t.YNc(5,w,2,0,"th",5),t.YNc(6,A,2,3,"td",6),t.BQk(),t.ynx(7,7),t.YNc(8,N,2,0,"th",5),t.YNc(9,U,2,1,"td",8),t.BQk(),t.ynx(10,9),t.YNc(11,S,2,0,"th",5),t.YNc(12,O,3,4,"td",8),t.BQk(),t.ynx(13,10),t.YNc(14,J,2,0,"th",5),t.YNc(15,F,3,4,"td",8),t.BQk(),t.ynx(16,11),t.YNc(17,B,2,0,"th",5),t.YNc(18,P,5,0,"td",8),t.BQk(),t.YNc(19,I,1,0,"tr",12),t.YNc(20,R,1,0,"tr",13),t.qZA()()()),2&o&&(t.Q6J("title","Cupones")("removeButton",!1)("description","Aqu\xed podr\xe1s crear, revisar, y editar todos tus cupones"),t.xp6(3),t.Q6J("dataSource",a.dataSource),t.xp6(16),t.Q6J("matHeaderRowDef",a.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",a.displayedColumns))},dependencies:[r.BZ,r.fO,r.as,r.w1,r.Dz,r.nj,r.ge,r.ev,r.XQ,r.Gk,_.Hw,b.gM,v.l,d.uU],styles:[".content-component[_ngcontent-%COMP%]{padding:30px}table[_ngcontent-%COMP%]{width:100%}.table-transactions[_ngcontent-%COMP%]{max-height:400px;overflow:auto}td[_ngcontent-%COMP%]{white-space:nowrap;text-overflow:ellipsis;overflow:hidden}"]}),e})()}];let Y=(()=>{class e{}return e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[m.Bz.forChild(Q),m.Bz]}),e})();var k=i(805),j=i(4429),V=i(6574);let $=(()=>{class e{}return e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[d.ez,Y,k.m8,j.q,v.l,g.p,s.UX,C.i,V.W]}),e})()}}]);