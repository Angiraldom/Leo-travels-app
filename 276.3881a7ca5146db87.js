"use strict";(self.webpackChunkleo_travels_app=self.webpackChunkleo_travels_app||[]).push([[276],{1276:(P,d,s)=>{s.r(d),s.d(d,{ProductsModule:()=>Y});var u=s(6895),a=s(4006),m=s(9066),p=s(7337),t=s(4650),f=s(5412),h=s(4684),v=s(9766),_=s(1740),T=s(5121),Z=s(7188),g=s(8142),C=s(3615);const y=function(){return{height:"180px"}};let M=(()=>{class e extends h.K{constructor(){super(...arguments),this.data=(0,t.f3M)(f.WI),this.dialogRef=(0,t.f3M)(f.so),this.selectedFiles=[],this.loading=!1,this.form=this.fb.group({_id:[],name:["",a.kI.required],description:["",a.kI.required],price:new a.NI({value:0,disabled:!0},{validators:a.kI.required}),taxes:[0,a.kI.required],priceWithoutTaxes:[0,a.kI.required],imageProperties:[]})}ngOnInit(){this.data&&this.form.patchValue(this.data),this.$taxes=this.form.get("taxes")?.valueChanges.subscribe({next:()=>this.calculatePrice()}),this.$priceWithoutTaxes=this.form.get("priceWithoutTaxes")?.valueChanges.subscribe({next:()=>this.calculatePrice()})}ngOnDestroy(){this.$priceWithoutTaxes&&this.$priceWithoutTaxes.unsubscribe(),this.$taxes&&this.$taxes.unsubscribe()}validateAction(){if(!this.form.invalid){if(this.loading=!0,!this.data)return void this.saveProduct();this.updateProduct()}}updateProduct(){const o=this.form.getRawValue();delete o.id;const n=new FormData;this.selectedFiles.forEach((r,l)=>{n.append("images",this.selectedFiles[l])}),n.append("data",JSON.stringify(o)),this.baseService.patchMethod("product/"+this.data._id,n).subscribe({next:()=>{this.messageService.succesMessage("succes.succesUpdate"),this.form.reset(),this.selectedFiles=[],this.loading=!1,this.dialogRef.close({refresh:!0})},error:()=>this.loading=!1})}saveProduct(){const o=this.form.getRawValue();delete o.id;const n=new FormData;this.selectedFiles.forEach((r,l)=>{n.append("images",this.selectedFiles[l])}),n.append("data",JSON.stringify(o)),this.baseService.postMethod("product",n).subscribe({next:()=>{this.messageService.succesMessage("succes.succesCreate"),this.form.reset(),this.selectedFiles=[],this.loading=!1,this.dialogRef.close({refresh:!0})},error:()=>this.loading=!1})}onFileSelected(o){const n=o.target.files[0];this.selectedFiles.push(n),this.setNameImage(n.name)}setNameImage(o){const n=this.form.get("imageProperties")?.value,r={key:o,url:""};n?(n.push(r),this.form.get("imageProperties")?.setValue(n)):this.form.get("imageProperties")?.setValue([r])}removeImage(o){this.selectedFiles=this.selectedFiles.filter(n=>n.name!==o.value.key)}calculatePrice(){const o=this.form.get("taxes")?.value,n=this.form.get("priceWithoutTaxes")?.value,r=o+n;this.form.get("price")?.setValue(r)}}return e.\u0275fac=function(){let i;return function(n){return(i||(i=t.n5z(e)))(n||e)}}(),e.\u0275cmp=t.Xpm({type:e,selectors:[["app-create-product"]],features:[t.qOj],decls:35,vars:19,consts:[[3,"titleModal"],[3,"formGroup"],[1,"content-form"],[1,"p-float-label"],["pInputText","","id","username","formControlName","name",1,"input-name"],["htmlFor","username"],["formControlName","description"],[1,"course-content-image"],["id","float-input","formControlName","priceWithoutTaxes","inputId","currency-us","mode","currency","currency","USD","locale","en-US"],["for","float-input"],["id","float-input","formControlName","taxes","inputId","currency-us","mode","currency","currency","USD","locale","en-US"],["id","float-input","formControlName","price","inputId","currency-us","mode","currency","currency","USD","locale","en-US"],[1,"content-images"],[1,"button-file"],["type","file","id","images","name","images",1,"custom-file-input",3,"change"],["for","images",1,"custom-file-label"],[1,"card","p-fluid"],["formControlName","imageProperties","field","key"],[3,"disabledButton","loading","handleSaveButton"]],template:function(o,n){1&o&&(t._UZ(0,"app-title-modal",0),t.TgZ(1,"form",1)(2,"div",2)(3,"span",3),t._UZ(4,"input",4),t.TgZ(5,"label",5),t._uU(6),t.ALo(7,"translate"),t.qZA()(),t._UZ(8,"p-editor",6),t.TgZ(9,"h3"),t._uU(10,"Especificaciones del producto"),t.qZA(),t.TgZ(11,"div",7)(12,"span",3),t._UZ(13,"p-inputNumber",8),t.TgZ(14,"label",9),t._uU(15),t.ALo(16,"translate"),t.qZA()(),t.TgZ(17,"span",3),t._UZ(18,"p-inputNumber",10),t.TgZ(19,"label",9),t._uU(20),t.ALo(21,"translate"),t.qZA()(),t.TgZ(22,"span",3),t._UZ(23,"p-inputNumber",11),t.TgZ(24,"label",9),t._uU(25),t.ALo(26,"translate"),t.qZA()()(),t.TgZ(27,"div",12)(28,"div",13)(29,"input",14),t.NdJ("change",function(l){return n.onFileSelected(l)}),t.qZA(),t.TgZ(30,"label",15),t._uU(31,"Cargar imagenes"),t.qZA()(),t.TgZ(32,"div",16),t._UZ(33,"p-chips",17),t.qZA()()()(),t.TgZ(34,"app-buttons-modal",18),t.NdJ("handleSaveButton",function(){return n.validateAction()}),t.qZA()),2&o&&(t.Q6J("titleModal","crear producto"),t.xp6(1),t.Q6J("formGroup",n.form),t.xp6(5),t.Oqu(t.lcZ(7,10,"products.form.name")),t.xp6(2),t.Akn(t.DdM(18,y)),t.xp6(7),t.Oqu(t.lcZ(16,12,"products.form.priceWithoutTaxes")),t.xp6(5),t.Oqu(t.lcZ(21,14,"products.form.taxes")),t.xp6(5),t.Oqu(t.lcZ(26,16,"products.form.price")),t.xp6(9),t.Q6J("disabledButton",n.form.invalid)("loading",n.loading))},dependencies:[a._Y,a.Fj,a.JJ,a.JL,a.sg,a.u,v.cL,_.o,T.ML,Z.Rn,g.i,C.p,m.X$],styles:[".custom-file-input[_ngcontent-%COMP%]{display:none}.custom-file-label[_ngcontent-%COMP%]{display:inline-block;padding:10px 20px;background-color:#222e5e;color:#fff;border-radius:5px;cursor:pointer}  .p-button{background:#222e5e}form[_ngcontent-%COMP%]{width:90%;margin:30px auto}.content-form[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr;grid-row-gap:30px}.content-form[_ngcontent-%COMP%]   .course-content-image[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3,1fr);justify-items:flex-start}.modules[_ngcontent-%COMP%]{max-height:220px;overflow-x:hidden;overflow-y:auto}.modules[_ngcontent-%COMP%]   .title-module[_ngcontent-%COMP%]{display:flex;align-items:center;column-gap:8px}.modules[_ngcontent-%COMP%]   .form-modules[_ngcontent-%COMP%]{margin:10px auto}textarea[_ngcontent-%COMP%], .input-name[_ngcontent-%COMP%]{width:100%}.content-three[_ngcontent-%COMP%]{width:335px;display:grid;grid-template-columns:repeat(3,1fr);gap:20px}.content-images[_ngcontent-%COMP%]{display:flex;width:100%;justify-content:space-between;max-height:45px}.content-images[_ngcontent-%COMP%]   .p-fluid[_ngcontent-%COMP%]{width:75%}  .p-fluid .p-chips{max-height:45px}.button-file[_ngcontent-%COMP%]{width:25%;min-width:195px;justify-self:flex-start}  .cdk-overlay-pane{min-width:70%}"]}),e})();var b=s(136),c=s(671),A=s(7392),O=s(266),x=s(9524);function U(e,i){1&e&&(t.TgZ(0,"th",12),t._uU(1," Producto "),t.qZA())}function N(e,i){if(1&e&&(t.TgZ(0,"td",13),t._uU(1),t.qZA()),2&e){const o=i.$implicit;t.Q6J("matTooltipPosition","left")("matTooltip",o.name),t.xp6(1),t.hij(" ",o.name," ")}}function S(e,i){1&e&&(t.TgZ(0,"th",12),t._uU(1," Descripci\xf3n "),t.qZA())}function w(e,i){if(1&e&&(t.TgZ(0,"td",13),t._uU(1),t.qZA()),2&e){const o=i.$implicit;t.Q6J("matTooltipPosition","left")("matTooltip",o.description),t.xp6(1),t.hij(" ",o.description," ")}}function D(e,i){1&e&&(t.TgZ(0,"th",12),t._uU(1," Precio "),t.qZA())}function F(e,i){if(1&e&&(t.TgZ(0,"td",14),t._uU(1),t.qZA()),2&e){const o=i.$implicit;t.xp6(1),t.hij(" ",o.price," ")}}function J(e,i){1&e&&(t.TgZ(0,"th",12),t._uU(1," Acciones "),t.qZA())}function I(e,i){if(1&e){const o=t.EpF();t.TgZ(0,"mat-icon",15),t.NdJ("click",function(){t.CHM(o);const r=t.oxw().$implicit,l=t.oxw();return t.KtG(l.confirmRemoveProduct(r))}),t._uU(1," delete "),t.qZA()}}function R(e,i){if(1&e){const o=t.EpF();t.TgZ(0,"td",14)(1,"mat-icon",15),t.NdJ("click",function(){const l=t.CHM(o).$implicit,W=t.oxw();return t.KtG(W.openModal(l))}),t._uU(2,"edit"),t.qZA(),t.YNc(3,I,2,0,"mat-icon",16),t.qZA()}if(2&e){const o=i.$implicit,n=t.oxw();t.xp6(3),t.Q6J("ngIf",n.idKitViajero!==o._id)}}function B(e,i){1&e&&t._UZ(0,"tr",17)}function j(e,i){1&e&&t._UZ(0,"tr",18)}const $=[{path:"",component:(()=>{class e extends h.K{constructor(){super(...arguments),this.createModal=M,this.products=[],this.idKitViajero=b.w,this.displayedColumns=["name","description","price","actions"]}ngOnInit(){this.getAllProducts()}ngOnDestroy(){this.$dialog&&this.$dialog.unsubscribe()}getAllProducts(){this.baseService.getMethod("product").subscribe({next:o=>{this.products=o.data,this.dataSource=o.data}})}openModal(o){this.$dialog=this.dialog.open(this.createModal,{hasBackdrop:!1,data:o}).afterClosed().subscribe({next:({refresh:n})=>{n&&this.getAllProducts()}})}confirmRemoveProduct(o){this.messageService.confirmRevomeMessage("info.confirmRemove").then(n=>{n.isConfirmed&&this.removeProduct(o)})}removeProduct(o){this.baseService.deleteMethod("product/"+o._id).subscribe({next:()=>{this.messageService.succesMessage("succes.succesRemove"),this.getAllProducts()}})}}return e.\u0275fac=function(){let i;return function(n){return(i||(i=t.n5z(e)))(n||e)}}(),e.\u0275cmp=t.Xpm({type:e,selectors:[["app-products"]],features:[t.qOj],decls:17,vars:6,consts:[[3,"title","removeButton","description","handleClick"],[1,"content-component"],["mat-table","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",3,"matTooltipPosition","matTooltip",4,"matCellDef"],["matColumnDef","description"],["matColumnDef","price"],["mat-cell","",4,"matCellDef"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell","",3,"matTooltipPosition","matTooltip"],["mat-cell",""],[3,"click"],[3,"click",4,"ngIf"],["mat-header-row",""],["mat-row",""]],template:function(o,n){1&o&&(t.TgZ(0,"app-header-modules",0),t.NdJ("handleClick",function(){return n.openModal()}),t.qZA(),t.TgZ(1,"div",1)(2,"table",2),t.ynx(3,3),t.YNc(4,U,2,0,"th",4),t.YNc(5,N,2,3,"td",5),t.BQk(),t.ynx(6,6),t.YNc(7,S,2,0,"th",4),t.YNc(8,w,2,3,"td",5),t.BQk(),t.ynx(9,7),t.YNc(10,D,2,0,"th",4),t.YNc(11,F,2,1,"td",8),t.BQk(),t.ynx(12,9),t.YNc(13,J,2,0,"th",4),t.YNc(14,R,4,1,"td",8),t.BQk(),t.YNc(15,B,1,0,"tr",10),t.YNc(16,j,1,0,"tr",11),t.qZA()()),2&o&&(t.Q6J("title","Productos")("removeButton",!1)("description","Aqu\xed podr\xe1s crear, revisar, y editar todos tus productos"),t.xp6(2),t.Q6J("dataSource",n.dataSource),t.xp6(13),t.Q6J("matHeaderRowDef",n.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",n.displayedColumns))},dependencies:[u.O5,c.BZ,c.fO,c.as,c.w1,c.Dz,c.nj,c.ge,c.ev,c.XQ,c.Gk,A.Hw,O.gM,x.l],styles:[".title[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:30px;background:#f2f2f2}.content-component[_ngcontent-%COMP%]{padding:30px}table[_ngcontent-%COMP%]{width:100%}td[_ngcontent-%COMP%]{max-width:100px;white-space:nowrap;text-overflow:ellipsis;overflow:hidden}"]}),e})()}];let Q=(()=>{class e{}return e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[p.Bz.forChild($),p.Bz]}),e})();var k=s(6574),q=s(4429);let Y=(()=>{class e{}return e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[u.ez,Q,a.UX,q.q,m.aw,k.W,g.i,C.p,x.l]}),e})()},136:(P,d,s)=>{s.d(d,{w:()=>u});const u="64a75cd97a31b132537ae59a"}}]);